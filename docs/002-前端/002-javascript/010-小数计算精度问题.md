# 小数

1. 数字类型只有 number 类型，number 类型相当于其他强类型语言中的 double 类型(双精度浮点型)，不区分浮点型和整数型。
2. 由于 Js 的所有数字类型都是双精度浮点型(64 位)，采用 IEEE754 标准 64 位二进制数表示一个 number 数字。
   其中 `64 位 = 1 位符号位 + 11 位指数位 + 52 位小数位`

3. 浮点数的运算精度丢失问题就是因为，浮点数转化为该标准的二进制的过程中出现的丢失。

    - 整数转二进制
      好理解，除二取余法，7 表示为 `111 = 1x2^3 + 1x2^2 + 1x2^1`。
    - 小数转二进制
      由于也需要转化为指数形式，例如 `1/2 = 1 _ 2^-1, 1/4 = 1 _ 2^-2`,
      所以小数的转化二进制过程是通过判断小数是不是满 1/2，1/4，8/1 以此类推，换成数学公式就是*乘二取整法*。
        ```js
        0.1.toString(2) // "0.0001100110011001100110011001100110011001100110011001101"
        0.1 * 2 = 0.2 // 0
        0.2 * 2 = 0.4 // 0
        0.4 * 2 = 0.8 // 0
        0.8 * 2 = 1.6 // 1，取出整数用小数继续乘以2
        0.6 * 2 = 1.2 // 1，取出整数用小数继续乘以2
        0.2 * 2 = 0.4 // 0 开始循环
  
        0.25.toString(2)
        0.01 ===> 0 * 2^-1 + 1 * 2^-2
        ```

4. 计算
计算机中的数字都是以二进制存储的，二进制浮点数表示法并不能精确的表示类似0.1这样 的简单的数字。
如果要计算 `0.1 + 0.2` 的结果，计算机会先把 `0.1` 和 `0.2` 分别转化成二进制，然后相加，最后再把相加得到的结果转为十进制。
但有一些浮点数在转化为二进制时，会出现无限循环 。比如， 十进制的 0.1 转化为二进制，会得到如下结果：
```js
0.1 => 0.0001 1001 1001 1001…（无限循环）
0.2 => 0.0011 0011 0011 0011…（无限循环）
```

而存储结构中的尾数部分最多只能表示 53 位。为了能表示 0.1，只能模仿十进制进行四舍五入了，但二进制只有 0 和 1 ， 于是变为 0 舍 1 入 。 
因此，0.1 在计算机里的二进制表示形式如下：
```js
0.1 => 0.0001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 101
0.2 => 0.0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 001
0.3 => 0.0100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 1100 110
```

用标准计数法表示如下：
```js
0.1 => (−1)0 × 2^4 × (1.1001100110011001100110011001100110011001100110011010)2
0.2 => (−1)0 × 2^3 × (1.1001100110011001100110011001100110011001100110011010)2
// 相加得到
(−1)0 × 2−2 × (1.0011001100110011001100110011001100110011001100110100)2=>.0.30000000000000004
```


# 参考文档：
https://www.cnblogs.com/zm-blogs/p/12909096.html
https://github.com/mqyqingfeng/Blog/issues/155


```js
// 0.0100110011001100110011001100110011001100110011001100110
function c(num){
    var str = String(num).split('.')[1]
    console.log(str)
    var i = 0
    var sum = 0
    while(i < str.length) {
        sum += Number(str[i]) * Math.pow(2, -i-1)
        i++
    }
    console.log('sum', sum)
}
```